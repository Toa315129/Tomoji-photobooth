<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tomoji Photo Booth</title>

<!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ó‡∏¢/‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© -->
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Sriracha&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#fff9f5;        /* ‡∏Ñ‡∏£‡∏µ‡∏°‡∏≠‡πà‡∏≠‡∏ô */
  --pink:#f9a9c3;
  --blue:#a7d8f7;
  --green:#b7e2c7;
  --accent:#ff70a6;
}
*{box-sizing:border-box}
body{margin:0;font-family:"Sriracha","Pacifico",cursive;background:var(--bg);color:#444}

/* ‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å */
.page{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
.app{width:100%;max-width:900px;background:#fff;border-radius:18px;padding:20px;box-shadow:0 8px 30px rgba(0,0,0,0.1)}

/* Header */
.header{text-align:center;margin-bottom:12px}
.header h1{font-family:"Pacifico",cursive;font-size:36px;color:var(--accent);margin:0}
.header p{font-family:"Sriracha",cursive;color:#666;margin:6px 0 0}

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ */
.preview{background:#fff;border:6px solid var(--blue);border-radius:16px;overflow:hidden;aspect-ratio:3/4;position:relative}
video{width:100%;height:100%;object-fit:cover}

/* ‡∏Å‡∏£‡∏≠‡∏ö 3 ‡∏ä‡πà‡∏≠‡∏á (‡∏Ç‡∏ô‡∏≤‡∏î 4x6 ‡∏ô‡∏¥‡πâ‡∏ß ‚Äì ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô 2:3) */
.result{width:400px;height:600px;background:#fff;margin:20px auto;border:6px solid var(--pink);border-radius:16px;padding:10px;display:flex;flex-direction:column;gap:8px;position:relative}

/* ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏ö‡∏ô‡∏Å‡∏£‡∏≠‡∏ö */
.result::before{
  content:"TOMOJI PHOTOBOOTH";
  position:absolute;
  top:-32px; left:50%;
  transform:translateX(-50%);
  font-family:"Pacifico",cursive;
  font-size:22px;
  background:var(--blue);
  color:#fff;
  padding:6px 14px;
  border-radius:20px;
  border:3px solid var(--accent);
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

/* ‡∏ä‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏û */
.slot{flex:1;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;border-radius:12px}
.slot img{width:100%;height:100%;object-fit:cover}

/* ‡∏Å‡∏£‡∏≠‡∏ö‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á */
.slot.heart{border:4px dashed var(--pink);background:#fff0f5}
.slot.square{border:4px solid var(--blue);background:#f0f9ff}
.slot.star{border:4px dotted var(--green);background:#f5fff8}

/* Controls */
.controls{margin-top:16px;display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
.btn{padding:10px 16px;border:none;border-radius:10px;font-family:"Sriracha";cursor:pointer;font-size:16px}
.btn.primary{background:var(--accent);color:#fff}
.btn.secondary{background:var(--blue);color:#000}
.btn:disabled{opacity:.5;cursor:not-allowed}

/* QR */
#qrcode{margin-top:12px;display:flex;align-items:center;justify-content:center;padding:10px;background:#fff;border:2px dashed var(--pink);border-radius:12px}
</style>
</head>
<body>
<div class="page">
  <div class="app">
    <div class="header">
      <h1>Sweet Photo Booth</h1>
      <p>‡πÇ‡∏ó‡∏ô‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏•‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡πÜ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏±‡∏ß‡πÉ‡∏à üíñ ‡∏î‡∏≤‡∏ß ‚ú® ‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°</p>
    </div>

    <div class="preview">
      <video id="video" autoplay playsinline></video>
    </div>

    <div class="controls">
      <button class="btn primary" id="shutter">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢</button>
      <button class="btn secondary" id="download" disabled>‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
      <button class="btn secondary" id="print" disabled>üñ®Ô∏è ‡∏õ‡∏£‡∏¥‡πâ‡∏ô</button>
      <button class="btn secondary" id="makeqr" disabled>üîó QR</button>
    </div>

    <!-- ‡∏Å‡∏£‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
    <div class="result" id="result">
      <div class="slot heart"><span>1</span></div>
      <div class="slot square"><span>2</span></div>
      <div class="slot star"><span>3</span></div>
    </div>

    <div id="qrcode">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ QR</div>
  </div>
</div>

<!-- QR library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<script>
const video = document.getElementById('video');
const shutter = document.getElementById('shutter');
const downloadBtn = document.getElementById('download');
const printBtn = document.getElementById('print');
const makeqrBtn = document.getElementById('makeqr');
const result = document.getElementById('result');
const slots = result.querySelectorAll('.slot');
const qrcodeEl = document.getElementById('qrcode');

let captures = [];

/* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á */
async function startCamera(){
  try{
    const stream = await navigator.mediaDevices.getUserMedia({video:true,audio:false});
    video.srcObject = stream;
  }catch(e){ alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ: "+e.message); }
}
startCamera();

/* ‡∏ñ‡πà‡∏≤‡∏¢ 3 ‡∏£‡∏π‡∏õ */
shutter.addEventListener('click', async ()=>{
  captures = [];
  for(let i=0;i<3;i++){
    const c = document.createElement('canvas');
    c.width = video.videoWidth; c.height = video.videoHeight;
    c.getContext('2d').drawImage(video,0,0,c.width,c.height);
    const url = c.toDataURL('image/png');
    captures.push(url);
    slots[i].innerHTML = `<img src="${url}">`;
    await new Promise(r=>setTimeout(r,500));
  }
  downloadBtn.disabled=false;
  printBtn.disabled=false;
  makeqrBtn.disabled=false;
});

/* ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î */
downloadBtn.addEventListener('click', ()=>{
  const c = document.createElement('canvas');
  c.width=400; c.height=600;
  const ctx=c.getContext('2d');
  ctx.fillStyle="#fff";ctx.fillRect(0,0,c.width,c.height);
  captures.forEach((imgUrl,i)=>{
    const img=new Image();
    img.onload=()=>{
      const h=190; const y=10+i*(h+5);
      ctx.drawImage(img,0,y,400,h);
      if(i===2){
        const a=document.createElement('a');
        a.href=c.toDataURL('image/png');
        a.download="tomojibooth.png";
        a.click();
      }
    };
    img.src=imgUrl;
  });
});

/* ‡∏õ‡∏£‡∏¥‡πâ‡∏ô */
printBtn.addEventListener('click', ()=>{
  const win = window.open();
  captures.forEach(img=>{
    win.document.write('<img src="'+img+'" style="width:200px;display:block;margin-bottom:8px">');
  });
  win.print();
});

/* QR Code */
makeqrBtn.addEventListener('click', ()=>{
  qrcodeEl.innerHTML="";
  const blob=new Blob([captures.join(",")],{type:"text/plain"});
  const url=URL.createObjectURL(blob);
  new QRCode(qrcodeEl,{text:url,width:128,height:128});
});
</script>
</body>
</html>
